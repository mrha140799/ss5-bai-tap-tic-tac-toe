<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CodeGym</title>
    <style>

    </style>
</head>
<body style="font-family: 'Courier New'">
<center>
    <h id="idText"></h>
    <input type="button" value="Nhập X" onclick="inputX();">
    <input type="button" value="Nhập O" onclick="inputO()">
</center>
<script>
    let idText = document.getElementById("idText");
    let htmlStr = "";
    let x = '.';
    let dem = 0;
    let chieuDai = parseInt(prompt("mời bạn nhập vào chiều dài của bàn cờ"));
    let arr = new Array(chieuDai);
    for (let i = 0; i < chieuDai; i++) {
        arr[i] = new Array(chieuDai);
    }
    for (let i = 0; i < arr.length; i++) {
        for (let j = 0; j < arr.length; j++) {
            arr[i][j] = x;
            htmlStr += arr[i][j] + "&nbsp;";
        }
        htmlStr += "</br>";
    }
    idText.innerHTML = htmlStr;

    function inputX() {
        htmlStr = "";
        let positionX = parseInt(prompt("Mời nhập vào tọa độ cột:"));
        let positionY = parseInt(prompt("Mời nhập vào tọa độ hàng:"));
        arr[positionY][positionX] = "x";
        for (let i = 0; i < arr.length; i++) {
            for (let j = 0; j < arr.length; j++) {
                htmlStr += arr[i][j] + "&nbsp;";
            }
            htmlStr += "</br>";
        }
        idText.innerHTML = htmlStr;
        DuyetNgang(arr , positionX , positionY);
        DuyetDoc(arr , positionX , positionY);
        DuyetCheoSac(arr , positionX , positionY);
        DuyetCheoHuyen(arr , positionX , positionY);

    }

    function inputO() {
        htmlStr = "";
        let positionX = parseInt(prompt("Mời nhập vào tọa độ cột:"));
        let positionY = parseInt(prompt("Mời nhập vào tọa độ hàng:"));
        arr[positionY][positionX] = "o";
        for (let i = 0; i < arr.length; i++) {
            for (let j = 0; j < arr.length; j++) {
                htmlStr += arr[i][j] + "&nbsp;";
            }
            htmlStr += "</br>";
        }
        idText.innerHTML = htmlStr;
        DuyetNgang(arr , positionX , positionY);
        DuyetDoc(arr , positionX , positionY);
        DuyetCheoSac(arr , positionX , positionY);
        DuyetCheoHuyen(arr , positionX , positionY);
    }


    function DuyetNgang(arr ,positionX,positionY) {
        if (positionX!= 0 && arr[positionY][positionX] == arr[positionY][positionX-1]){
            DuyetNgang(arr , positionX -1 , positionY);
        } else {
            let dem = 0;
            let tg = arr[positionY][positionX] ;
            for (let i = positionX ; i < arr.length ; i ++) {
                if(arr[positionY][i] == tg) {
                    dem++;
                }else {
                    break;
                }
            }
            if (dem >= 3) {
                alert("người chơi "+tg +" win");
            }
        }
    }
    function DuyetDoc(arr ,positionX,positionY) {
        if (positionY!= 0 && arr[positionY][positionX] == arr[positionY-1][positionX]){
            DuyetDoc(arr , positionX , positionY-1);
        } else {
            let dem = 0;
            let tg = arr[positionY][positionX] ;
            for (let i = positionY ; i < arr.length ; i ++) {
                if(arr[i][positionX] == tg) {
                    dem++;
                }else {
                    break;
                }
            }
            if (dem >= 3) {
                alert("người chơi "+tg +" win");
            }
        }
    }
    function DuyetCheoSac(arr ,positionX,positionY) {
        if ((positionX != arr.length-1 || positionY != 0) && (arr[positionY][positionX]==arr[positionY-1][positionX+1])) {
            console.log("x:" +positionX + " y:" +positionY);
            DuyetCheoSac(arr , positionX+1 , positionY-1);
        }else {
            let dem = 0;
            let tg = arr[positionY][positionX] ;
            let y = positionY;
            for (let i = positionX ; i >=0 ; i--) {
                if (arr[y][i] == tg) {
                    dem++;
                    console.log(dem);
                    y++;
                }else {
                    break;
                }
            }
            if (dem >= 3) {
                alert("người chơi "+tg +" win");
            }
        }
    }
    function DuyetCheoHuyen(arr ,positionX,positionY) {
        if ((positionX !=0 || positionY != 0) && (arr[positionY][positionX]==arr[positionY-1][positionX-1])) {
            console.log("x:" +positionX + " y:" +positionY);
            DuyetCheoHuyen(arr , positionX-1 , positionY-1);
        }else {
            let dem = 0;
            let tg = arr[positionY][positionX] ;
            let y = positionY;
            for (let i = positionX ; i <arr.length; i++) {
                if (arr[y][i] == tg) {
                    dem++;
                    console.log(dem);
                    y++;
                }else {
                    break;
                }
            }
            if (dem >= 3) {
                alert("người chơi "+tg +" win");
            }
        }
    }

</script>
</body>
</html>